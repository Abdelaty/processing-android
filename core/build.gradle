apply plugin: 'java'

buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath group: 'commons-io', name: 'commons-io', version: '2.5'
        classpath group: 'org.zeroturnaround', name: 'zt-zip', version: '1.9'


    }
}

// Find location of Android-23 android jar relative to ANDROID_HOME
def android_23 = "$sdkdir/platforms/android-23"


repositories {
        //jcenter()
        flatDir {dirs 'library', android_23}
}

// Check to see if API 23 exists
// TODO: Look for any 23+ SDK and use it.
if (!file(android_23).exists()) {
    logger.error "Android SDK 23 could not be found in $sdkdir"
}



dependencies {
    compile name: 'android'
    compile name: 'android-support-v4'
    compile name: 'wearable-1.3.0-classes'
}

sourceSets {
    main {
        java {
            srcDirs = ['src/']
        }
    }
}


// Create Jar
jar {
    manifest {
        attributes(
                "Manifest-Version": "1.0",
                "Gradle-Version": "$gradle.gradleVersion"
        )
    }

}

import groovy.util.AntBuilder

import org.apache.commons.io.FileUtils

import org.zeroturnaround.zip.ZipUtil

task dist {
    doLast {
        // Copy shaders to build dir
        FileUtils.copyDirectory(file("src/assets"), file("$buildDir/zip/assets"))
        FileUtils.copyDirectory(file("$buildDir/classes/main"), file("$buildDir/zip/"))

        ZipUtil.pack(file("$buildDir/zip"), new File("$buildDir/libs/android-core.zip"))
    }
}

dist.dependsOn build