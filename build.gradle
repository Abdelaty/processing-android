apply plugin: 'java'

buildscript {
    repositories {
        google()
        jcenter()
    }
    dependencies {
        classpath 'com.android.tools.build:gradle:3.0.1'
    }
}

allprojects {
    Properties modeProperties = new Properties()
    modeProperties.load(project.rootProject.file('mode/mode.properties').newDataInputStream())
    ext.modeVersion = modeProperties.getProperty('prettyVersion')

    Properties vrProperties = new Properties()
    vrProperties.load(project.rootProject.file('mode/libraries/vr/library.properties').newDataInputStream())
    ext.vrVersion = vrProperties.getProperty('prettyVersion')

    def targetSdkVersion = 26
    Properties localProperties = new Properties()
    localProperties.load(project.rootProject.file('local.properties').newDataInputStream())
    def sdkDir = localProperties.getProperty('sdk.dir')
    ext.androidPlatformPath = "${sdkDir}/platforms/android-${targetSdkVersion}"
    ext.androidToolsLibPath = "${sdkDir}/tools/lib"

    ext.coreZipPath = "$rootDir/mode/processing-core.zip"
    
    repositories {
        google()
        jcenter()
        flatDir dirs: androidPlatformPath
        flatDir dirs: androidToolsLibPath
        flatDir dirs: "$rootDir/core/dist"
    }

    sourceCompatibility = 1.7
    targetCompatibility = 1.7    
}

clean.doFirst {
    delete "dist"
}
